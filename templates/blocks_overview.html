{% for block in blocks %}
<li
  class="block"
  :class="{ 'block-closed': !open }"
  x-data="{ 'open': false }"
  @click="open = true"
  @click.outside="open = false"
  >
  <div class="block-header">
    <p class="hash">{{ block.short_hash() }}{% if show_all && main_chain_hashes.contains(block.hash) %} (in main blockchain){% endif %}</p>
    <p class="block-name">{{ block.name }}</p>
  </div>
  <hr/>
  <div class="block-message"><pre>{{ block.message }}</pre></div>
  <div x-show="open" :data-block-details-open="open">
    <table class="block-details">
      <caption>Block #{{ block.height }} details</caption>
      <tbody>
        <tr>
          <td>Scramble</td>
          <td>{{ block.scramble() }}</td>
        </tr>
        <tr>
          <td>Solution</td>
          <td>{{ block.solution }}</td>
        </tr>
        <tr>
          <td>Description</td>
          <td>{{ block.solution_description }}</td>
        </tr>
      </tbody>
    </table>
    <button
      class="button button-primary"
      hx-get="/block?parent_hash={{ block.hash }}"
      hx-swap="beforeend"
      hx-target="body"
      hx-trigger="click[!document.querySelector('.modal')]"
    >Add a new block</button>
  </div>
  {% if let Some(timestamp) = block.created_at %}
  <p class="block-createdat">{{ timestamp }}</p>
  {% endif %}
</li>
{% endfor %}
{% if blocks.len() as u32 == page_size %}
<li
  hx-get="/blocks?all={{ show_all }}&page_size={{ page_size }}&page_offset={{ next_offset }}"
  hx-trigger="revealed"
  hx-swap="outerHTML"
>
  Loading more blocks...
</li>
{% endif %}
